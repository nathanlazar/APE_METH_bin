# nathan dot lazar at gmail dot com

read_bp <- function(bp_file, seqinfo) {
########################################################
# Read in Breakpoint region data and make GRanges object
########################################################
  bps <- read.table(bp_file, sep="\t", header=F,
    blank.lines.skip=T, strip.white=T, fill=T)
  if(ncol(bps) > 6)
    bps <- bps[,1:6]
  if(ncol(bps)==6)
    names(bps)=c('chr', 'start', 'end', 'BP_name', 'size', 'class')
  if(ncol(bps)==3)
    names(bps)=c('chr', 'start', 'end', 'BP_name')
  bps$chr <- paste0('chr', bps$chr)

  bp.gr <- makeGRangesFromDataFrame(bps, keep.extra.columns=T)
  seqlevels(bp.gr) <- seqlevels(seqinfo)
  seqlengths(bp.gr) <- seqlengths(seqinfo)
  genome(bp.gr) <- genome(seqinfo)

  sort(bp.gr)
}

